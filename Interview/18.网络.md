### HTTP

HTTP直接通过明文在浏览器和服务器之间传递信息

HTTPS采用 `对称加密` 和 `非对称加密` 结合的方式来保护浏览器和服务端之间的通信安全，对称加密算法加密数据+非对称加密算法交换密钥+数字证书验证身份=安全



http 通信过程：

1. 解析域名，得到对应的ip地址
2. 浏览器请求服务器，三次握手
3. 浏览器发起一次http报文请求
4. 服务器接收请求并返回结果
5. 浏览器获取结果并解析成html代码
6. 浏览器渲染并返回给用户
7. 服务器关闭连接，四次挥手



### HTTPS 

`HTTPS`超文本传输安全协议，是以安全为目标的HTTP通道，简单讲是`HTTP`的安全版

![截屏2021-09-20 下午8.21.37.png](https://i.loli.net/2021/09/20/ClbMnwfySg7O8Fc.png)

HTTPS其实是由两部分组成：`HTTP + SSL / TLS`，也就是在HTTP上又加了一层处理加密信息的模块，服务端和客户端的信息传输都会通过TLS进行加密，所以传输的数据都是加密后的数据：

1. 传统的HTTP报文是直接将报文信息传输到TCP，然后TCP再通过TCP套接字发送给目的主机上

2. HTTPS是HTTP报文直接将报文信息传输给SSL套接字进行加密，SSL加密后将加密后的报文发送给TCP套接字，然后TCP套接字再将加密后的报文发送给目的主机，目的主机将通过TCP套接字获取加密后的报文给SSL套接字，SSL解密后交给对应进程

   ![截屏2021-09-20 下午8.31.09.png](https://i.loli.net/2021/09/20/C1terjKS7yo2VUM.png)





#### HTTPS加密请求 / 一次握手 过程

1. 客户端发起握手请求，以明文传输请求信息

2. 服务端的配置，采用HTTPS协议的服务器必须要有一套数字证书，可以自己制作，也可以向组织申请，证书其实就是一对公钥和私钥

3. 服务端返回协商的信息结果，包括选择使用的协议版本 version，选择的压缩算法 compression method、证书等，`这个证书其实就是公钥，只是包含了很多信息，如证书的颁发机构，过期时间等等` 

4. 客户端验证证书的合法性，包括可信性，是否吊销，过期时间和域名，这部分工作由客户端的SSL/TLS来完成，首先会验证公钥是否有效，如果证书没有问题，那么就生成一个随机值，然后用证书，也就是公钥，对这个随机值进行加密

5. 客户端使用公匙对对称密匙加密，发送给服务端，这部分传送的是用证书加密后的随机值，目的是让服务端得到这个随机值，以后客户端和服务端的通信就可以通过这个随机值来进行加密解密

6. 服务器用私钥解密，拿到对称加密的密匙

7. 传输加密后的信息，这部分信息就是服务端用私钥加密后的信息，可以在客户端用随机值解密还原

8. 客户端解密信息，客户端用之前生产的私钥解密服务端传过来的信息，于是获取了解密后的内容

   

   



### 参考

[Artifacts - HTTPS加密（握手）过程](https://www.jianshu.com/p/e30a8c4fa329)



## 

### HTTPS 是怎么加密的

### 普通 Hash 和一致性 Hash 原理

### 一致性 Hash 的缺点

### TCP 三次握手过程，为什么需要三次握手

### 为什么 TIME_WAIT 状态需要经过 2MSL 才能返回到 CLOSE 状态

### TCP 的拥塞控制

### TCP 如何解决流控、乱序、丢包问题

### 为什么会出现粘包和拆包，如何解决



### TCP / HTTP

TCP协议对应于传输层，而HTTP协议对应于应用层，从本质上来说，二者没有可比性。但是，http是基于tcp协议的，TCP/IP 协议分层模型：

1. 物理层将二进制的0和1和电压高低，光的闪灭和电波的强弱信号进行转换

2. 链路层代表驱动

3. 网络层

4. - 使用 IP 协议，IP 协议基于 IP 转发分包数据
   - IP 协议是个不可靠协议，不会重发
   - IP 协议发送失败会使用ICMP 协议通知失败
   - ARP 解析 IP 中的 MAC 地址，MAC 地址由网卡出厂提供
   - IP 还隐含链路层的功能，不管双方底层的链路层是啥，都能通信

5. 传输层

6. - TCP 协议面向有连接，能正确处理丢包，传输顺序错乱的问题，但是为了建立与断开连接，需要至少7次的发包收包，资源浪费
   - UDP 面向无连接，不管对方有没有收到，如果要得到通知，需要通过应用层
   - 通用的 TCP 和 UDP 协议

7. 会话层以上分层

8. - TCP/IP 分层中，会话层，表示层，应用层集中在一起
   - 网络管理通过 SNMP 协议



### TCP三次握手和四次挥手

**三次握手：**

1. 客户端–发送带有SYN标志的数据包–一次握手–服务端
2. 服务端–发送带有SYN/ACK标志的数据包–二次握手–客户端
3. 客户端–发送带有带有ACK标志的数据包–三次握手–服务端



**四次挥手：**

1. 客户端-发送一个FIN，用来关闭客户端到服务器的数据传送
2. 服务器-收到这个FIN，它发回一个ACK，确认序号为收到的序号加1 。和SYN一样，一个FIN将占用一个序号
3. 服务器-关闭与客户端的连接，发送一个FIN给客户端
4. 客户端-发回ACK报文确认，并将确认序号设置为收到序号加1









